# PH2-03: 学習履歴と進捗ステータス管理を実装する

## 1. メタ情報
- **タスクID**: PH2-03
- **タイトル**: ユーザーごとの課題ステータス管理
- **フェーズ**: Phase2
- **カテゴリ**: Backend
- **担当**: _(TBD)_
- **ステータス**: Planned
- **関連Issue/PR**: PH1-08（永続化方針）

## 2. 背景・目的
- 課題の進捗（未着手/進行中/完了）や学習履歴を保存し、ユーザー体験を向上させる。
- フィルタリングやレコメンドの基礎データとなる。

## 3. ゴールと非ゴール
- **ゴール**
  - ユーザーID + 課題IDのステータスを保存するデータモデルを実装。
  - APIでステータス取得・更新ができる。
- **非ゴール**
  - 認証基盤の実装（仮IDやセッションで代替可）。

## 4. スコープ詳細
- **対象**: リポジトリ（JSON or DB）、サービス層、API。
- **データ**: `TaskStatus` (`not_started`, `in_progress`, `completed`)。

## 5. 実施ステップ
1. 永続化方式（PH1-08の結論）に基づきテーブルまたはJSON構造を設計。
2. ステータス取得/更新用のAPIを追加。
3. 既存課題一覧APIにステータス情報を付与（ユーザー識別がある場合）。
4. pytestでユースケースをカバー。

## 6. 成果物
- モデル/リポジトリ実装。
- API + テスト。

## 7. 依存・ブロッカー
- **前提**: ユーザー識別方法を決める必要（暫定トークンでも可）。
- **考慮事項**: 複数デバイスで同期できるよう設計。

## 8. リスクと対策
| リスク | 影響 | 対策 |
| --- | --- | --- |
| ユーザー識別が未決定 | 実装待ち | MVPではローカルストレージIDと紐づけ、後で本IDに移行 |

## 9. テスト
- pytest：ステータス更新/取得のユニットテスト。

## 10. 計測
- なし。

## 11. ドキュメント
- `docs/domain/` にステータス仕様を追記。

## 12. タイムライン
- TBD

## 13. チェックリスト
- [ ] データモデル設計
- [ ] API実装
- [ ] テスト
- [ ] ドキュメント
- [ ] PRマージ

---
**考慮事項**: プライバシー要件（個人情報扱い）やデータ保持期間が必要か確認。*** End Patch
