# PH2-01: 課題フィルタリングAPIを実装する

## 1. メタ情報
- **タスクID**: PH2-01
- **タイトル**: 難易度・タグ・ステータスで課題を検索できるAPI
- **フェーズ**: Phase2
- **カテゴリ**: Backend
- **担当**: _(TBD)_
- **ステータス**: Planned
- **関連Issue/PR**: PH0-05（State準備）

## 2. 背景・目的
- ユーザーが自分に適した課題を探せるよう、難易度やタグによるフィルタリング機能が必要。
- API側でフィルタリングを提供し、フロントからクエリパラメータで指定できるようにする。

## 3. ゴールと非ゴール
- **ゴール**
  - `/api/tasks` にクエリパラメータ（`difficulty`, `tags`, `status` 等）を追加し、絞り込み結果を返却。
  - 入力値検証とエラーハンドリングを実装。
- **非ゴール**
  - 高度な検索（全文検索など）。

## 4. スコープ詳細
- **対象**: FastAPIルート、サービス層、リポジトリ。
- **ステータス**: 学習履歴導入後（PH2-03）のデータを想定。

## 5. 実施ステップ
1. クエリパラメータ仕様を決定（複数タグはカンマ区切り等）。
2. サービス層でフィルタ処理を実装。
3. JSONリポジトリでもフィルタが利用できるよう関数拡張。
4. pytestでフィルタリングテストを追加。

## 6. 成果物
- API実装コード + テスト。

## 7. 依存・ブロッカー
- **前提**: PH0-05でフィルタstateがフロントに存在。
- **考慮事項**: 将来的にDBへ移行するとクエリ最適化が必要。

## 8. リスクと対策
| リスク | 影響 | 対策 |
| --- | --- | --- |
| JSON実装でパフォーマンス劣化 | 応答遅延 | データ件数が増えたらDB移行を早める |

## 9. テスト
- `pytest` で様々なクエリ組み合わせを検証。

## 10. 計測
- 大きめのデータセットでレスポンスタイムを測定。

## 11. ドキュメント
- API仕様書にクエリパラメータを追記。

## 12. タイムライン
- TBD

## 13. チェックリスト
- [ ] パラメータ仕様決定
- [ ] 実装
- [ ] テスト
- [ ] ドキュメント更新
- [ ] PRマージ

---
**考慮事項**: ステータス情報はPH2-03実装後に利用可能になるため、暫定的には難易度/タグのみ対応でもよい。*** End Patch
