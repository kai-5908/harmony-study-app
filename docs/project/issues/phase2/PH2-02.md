# PH2-02: フィルタリングUIをAPIと連携する

## 1. メタ情報
- **タスクID**: PH2-02
- **タイトル**: ソート/フィルタUIとAPIレスポンスの連動
- **フェーズ**: Phase2
- **カテゴリ**: Frontend
- **担当**: _(TBD)_
- **ステータス**: Planned
- **関連Issue/PR**: PH0-05, PH2-01

## 2. 背景・目的
- フロントで保持しているフィルタstateを実際のAPI呼び出しに反映し、結果一覧へ適用する。
- ユーザーが操作した条件がURLや状態に反映され、再訪しても同じ表示ができるようにする。

## 3. ゴールと非ゴール
- **ゴール**
  - `HarmonyTaskList` からAPI呼び出し時にクエリを付与。
  - フィルタ変更で再フェッチし、結果が更新される。
  - URLクエリ同期（任意）。
- **非ゴール**
  - 複数タブ間同期や高度な検索UI。

## 4. スコープ詳細
- **対象コード**: `HarmonyTaskList`, `HarmonyTaskAPI`, 可能ならReact Query等の導入。

## 5. 実施ステップ
1. APIクライアントにクエリパラメータ引数を追加。
2. state変化を監視して再取得するロジックを実装（`useEffect` or React Query）。
3. 読み込み状態・エラー表示を強化。
4. テストで条件変更時にfetch関数が呼ばれることを確認。

## 6. 成果物
- フロント改修 + テスト。

## 7. 依存・ブロッカー
- **前提**: PH2-01のAPI提供。
- **考慮事項**: URL同期を行う場合はReact Router v6のSearch Params対応が必要。

## 8. リスクと対策
| リスク | 影響 | 対策 |
| --- | --- | --- |
| リクエストが増えて遅くなる | 体験悪化 | デバウンスやキャッシュを検討 |

## 9. テスト
- Vitest/RTLでフィルタ操作→API呼び出しモック検証。

## 10. 計測
- なし（必要ならローディング時間を測定）。

## 11. ドキュメント
- `docs/project/development-guidelines.md` にフィルタ仕様を追記。

## 12. タイムライン
- TBD

## 13. チェックリスト
- [ ] クエリ付きAPI呼び出し
- [ ] 再フェッチ処理
- [ ] テスト
- [ ] PRマージ

---
**考慮事項**: 将来的に無限スクロールやページネーションを追加する場合、状態管理方法を拡張しやすい構造にする。*** End Patch
