# PH1-07: 鍵盤UIを実装し提出フローへ接続する

## 1. メタ情報
- **タスクID**: PH1-07
- **タイトル**: 鍵盤UIで音入力 → 提出API連携
- **フェーズ**: Phase1
- **カテゴリ**: Frontend / UX
- **担当**: _(TBD)_
- **ステータス**: Planned
- **関連Issue/PR**: PH1-04（提出フロー）

## 2. 背景・目的
- ユーザーが視覚的に和音を入力できるUIが必須。暫定フォームでは体験が弱い。
- ピアノ鍵盤や音名ボタンで入力できるUIを提供し、提出APIへ送信する。

## 3. ゴールと非ゴール
- **ゴール**
  - 小型の鍵盤コンポーネントを実装し、クリック/タップで音を選択。
  - 選択結果を内部データ構造に変換し、PH1-04で実装したAPIに提出。
- **非ゴール**
  - MIDIキーボードや高度な演奏入力（Phase2以降）。

## 4. スコープ詳細
- **対象コード**: 新規 `PianoInput` コンポーネント等。
- **データ構造**: chord/voiceごとの音名+オクターブ。

## 5. 実施ステップ
1. 入力仕様（同時押し数、声部の扱い）を決める。
2. UIコンポーネントを作成し、状態管理（voiceごと）を実装。
3. 提出ボタンからPH1-04のAPIクライアントを呼び出す。
4. テストとUXの軽微な調整（レスポンシブ対応、アクセシビリティ）。

## 6. 成果物
- 鍵盤UIコンポーネント。
- テスト（ユーザーイベントで音選択→送信）。

## 7. 依存・ブロッカー
- **前提**: PH1-04が完了しAPIアクセス可能。
- **考慮事項**: 4声同時入力のUI設計。音名表記（♯/♭）選択も検討。

## 8. リスクと対策
| リスク | 影響 | 対策 |
| --- | --- | --- |
| UIが複雑で操作しづらい | ユーザー離脱 | 最小限の機能でリリースし、ユーザーテストで改善 |
| 入力フォーマット不一致 | 提出失敗 | 禁則APIの要求フォーマットを型で共有 |

## 9. テスト
- Vitest/RTLでクリック→state更新→API呼び出しをモックして確認。
- 手動で複数声部入力を検証。

## 10. 計測
- ユーザビリティテスト時に操作ステップ数を記録（任意）。

## 11. ドキュメント
- `docs/project/development-guidelines.md` にUI構成と入力仕様を記載。

## 12. タイムライン
- TBD

## 13. チェックリスト
- [ ] UI仕様決定
- [ ] コンポーネント実装
- [ ] API連携
- [ ] テスト
- [ ] PRマージ

---
**考慮事項**: 後続でMIDIキーボード対応を検討するため、内部データ構造を拡張しやすく設計。*** End Patch
